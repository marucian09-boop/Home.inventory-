<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .dark .dark\:bg-gray-800 { background-color: #1f2937; }
        .dark .dark\:bg-gray-900 { background-color: #111827; }
        .dark .dark\:border-gray-700 { border-color: #374151; }
        .dark .dark\:text-gray-300 { color: #d1d5db; }
        .dark .dark\:text-gray-400 { color: #9ca3af; }
        .dark .dark\:hover\:bg-gray-700:hover { background-color: #374151; }
        .dark .dark\:focus\:ring-offset-gray-800:focus { --tw-ring-offset-color: #1f2937; }
        .tab-active {
            border-color: #4f46e5;
            color: #ffffff;
        }
        /* Custom scrollbar for dark mode */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #4a5568;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #718096;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300">

<div id="app" class="p-4 sm:p-6 lg:p-8">
    <!-- Header -->
    <header class="flex flex-wrap justify-between items-center pb-4 mb-4 border-b border-gray-700">
        <div>
            <h1 class="text-xl font-bold text-white">Inventory Dashboard</h1>
            <p id="userEmailDisplay" class="text-sm">yujinandrade@gmail.com <span class="text-xs font-semibold ml-2 px-2 py-0.5 bg-indigo-600 text-white rounded-full">Admin</span></p>
        </div>
        <div class="flex items-center space-x-4 mt-4 sm:mt-0">
            <button id="signOutBtn" class="px-4 py-2 text-sm font-semibold bg-red-600 hover:bg-red-700 rounded-lg transition-colors">Sign Out</button>
            <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-700">
                <svg id="theme-toggle-dark-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
            </button>
        </div>
    </header>

    <!-- Date Controls -->
    <div class="flex flex-wrap items-center gap-4 p-4 mb-6 bg-gray-800 rounded-lg">
        <div class="flex items-center">
            <label for="date-picker" class="text-sm mr-2">Showing data for:</label>
            <input type="date" id="date-picker" class="bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm focus:ring-indigo-500 focus:border-indigo-500">
        </div>
        <button id="todayBtn" class="px-4 py-2 text-sm font-semibold bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors">Today</button>
        <button class="px-4 py-2 text-sm font-semibold bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors">Download Daily Report</button>
    </div>

    <!-- Main Content -->
    <div class="bg-gray-800 rounded-lg p-2 sm:p-4">
        <!-- Tabs -->
        <div class="border-b border-gray-700">
            <nav class="flex flex-wrap -mb-px" aria-label="Tabs">
                <a href="#" class="tab-link whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-400 hover:border-gray-500 hover:text-gray-300" data-tab="dashboard">Dashboard</a>
                <a href="#" class="tab-link whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-400 hover:border-gray-500 hover:text-gray-300" data-tab="deliveries">Deliveries</a>
                <a href="#" class="tab-link whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-400 hover:border-gray-500 hover:text-gray-300" data-tab="stocks">Stocks</a>
                <a href="#" class="tab-link whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-400 hover:border-gray-500 hover:text-gray-300" data-tab="sales">Sales</a>
                <a href="#" class="tab-link tab-active whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2" data-tab="transfer-out">Transfer Out</a>
                <a href="#" class="tab-link whitespace-nowrap py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-400 hover:border-gray-500 hover:text-gray-300" data-tab="transfer-in">Transfer In</a>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="pt-6">
            <div id="dashboard-content" class="tab-content hidden">Dashboard Content</div>
            <div id="deliveries-content" class="tab-content hidden">Deliveries Content</div>
            <div id="stocks-content" class="tab-content hidden">Stocks Content</div>
            <div id="sales-content" class="tab-content hidden">Sales Content</div>
            
            <!-- Transfer Out Content -->
            <div id="transfer-out-content" class="tab-content">
                <h2 class="text-2xl font-bold mb-4 text-white">Transfer Stock Out</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <input type="text" id="transfer-out-imei" placeholder="15-Digit IMEI" class="bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm focus:ring-indigo-500 focus:border-indigo-500">
                    <input type="text" id="transfer-out-notes" placeholder="Notes (e.g., Destination, Reason)" class="bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <button class="w-full py-3 text-sm font-bold bg-red-600 hover:bg-red-700 rounded-lg transition-colors mb-8">Transfer Out</button>

                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-white">Transfers Out for <span id="transfer-out-date"></span></h3>
                    <button class="px-4 py-2 text-sm font-semibold bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors">Download CSV</button>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm text-left">
                        <thead class="bg-gray-700 text-xs uppercase">
                            <tr>
                                <th scope="col" class="px-6 py-3">IMEI</th>
                                <th scope="col" class="px-6 py-3">Brand</th>
                                <th scope="col" class="px-6 py-3">Model</th>
                                <th scope="col" class="px-6 py-3">Variant</th>
                                <th scope="col" class="px-6 py-3">Notes</th>
                                <th scope="col" class="px-6 py-3">Date</th>
                                <th scope="col" class="px-6 py-3">Author</th>
                                <th scope="col" class="px-6 py-3 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transfer-out-table">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Transfer In Content -->
            <div id="transfer-in-content" class="tab-content hidden">
                 <h2 class="text-2xl font-bold mb-4 text-white">Transfer Stock In</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <input type="text" id="transfer-in-imei" placeholder="15-Digit IMEI" class="bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm focus:ring-indigo-500 focus:border-indigo-500">
                    <input type="text" id="transfer-in-notes" placeholder="Notes (e.g., Source)" class="bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <button class="w-full py-3 text-sm font-bold bg-green-600 hover:bg-green-700 rounded-lg transition-colors mb-8">Transfer In</button>

                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-white">Transfers In for <span id="transfer-in-date"></span></h3>
                    <button class="px-4 py-2 text-sm font-semibold bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors">Download CSV</button>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm text-left">
                        <thead class="bg-gray-700 text-xs uppercase">
                            <tr>
                                <th scope="col" class="px-6 py-3">IMEI</th>
                                <th scope="col" class="px-6 py-3">Brand</th>
                                <th scope="col" class="px-6 py-3">Model</th>
                                <th scope="col" class="px-6 py-3">Variant</th>
                                <th scope="col" class="px-6 py-3">Notes</th>
                                <th scope="col" class="px-6 py-3">Date</th>
                                <th scope="col" class="px-6 py-3">Author</th>
                                <th scope="col" class="px-6 py-3 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transfer-in-table">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Modal -->
<div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
    <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md">
        <h2 class="text-xl font-bold text-white mb-4">Edit Entry</h2>
        <form id="edit-form">
            <input type="hidden" id="edit-id">
            <input type="hidden" id="edit-type">
            <div class="space-y-4">
                <div>
                    <label for="edit-imei" class="block text-sm font-medium mb-1">IMEI</label>
                    <input type="text" id="edit-imei" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm" readonly>
                </div>
                 <div>
                    <label for="edit-notes" class="block text-sm font-medium mb-1">Notes</label>
                    <textarea id="edit-notes" rows="3" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 text-sm"></textarea>
                </div>
            </div>
            <div class="mt-6 flex justify-end space-x-4">
                <button type="button" id="cancel-edit-btn" class="px-4 py-2 text-sm font-semibold bg-gray-600 hover:bg-gray-500 rounded-lg">Cancel</button>
                <button type="submit" class="px-4 py-2 text-sm font-semibold bg-indigo-600 hover:bg-indigo-700 rounded-lg">Save Changes</button>
            </div>
        </form>
    </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Mock Data ---
    const MOCK_DATA = {
        transfersOut: [
            { id: 1, imei: '454552532442343', brand: 'Infinix', model: 'Q1', variant: '128GB', notes: 'Transfer to main branch', date: '2025-09-12', author: 'yujinandrade@gmail.com' },
            { id: 2, imei: '987654321012345', brand: 'Samsung', model: 'S23', variant: '256GB', notes: 'Return to supplier', date: '2025-09-12', author: 'admin@example.com' },
        ],
        transfersIn: [
            { id: 3, imei: '112233445566778', brand: 'Apple', model: 'iPhone 15', variant: '512GB', notes: 'From supplier warehouse', date: '2025-09-12', author: 'yujinandrade@gmail.com' },
        ],
    };

    // --- State ---
    let transfersOut = MOCK_DATA.transfersOut;
    let transfersIn = MOCK_DATA.transfersIn;
    
    // --- UI Elements ---
    const datePicker = document.getElementById('date-picker');
    const todayBtn = document.getElementById('todayBtn');
    const transferOutDateSpan = document.getElementById('transfer-out-date');
    const transferInDateSpan = document.getElementById('transfer-in-date');
    const transferOutTable = document.getElementById('transfer-out-table');
    const transferInTable = document.getElementById('transfer-in-table');
    const tabs = document.querySelectorAll('.tab-link');
    const tabContents = document.querySelectorAll('.tab-content');
    const editModal = document.getElementById('edit-modal');
    const editForm = document.getElementById('edit-form');
    const cancelEditBtn = document.getElementById('cancel-edit-btn');
    const themeToggle = document.getElementById('theme-toggle');
    const lightIcon = document.getElementById('theme-toggle-light-icon');
    const darkIcon = document.getElementById('theme-toggle-dark-icon');
    
    // --- Date Formatting ---
    const formatDate = (date) => {
        return new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    };

    const setDateValue = (date) => {
        const isoDate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
        datePicker.value = isoDate;
        const formatted = formatDate(new Date(datePicker.value + 'T00:00:00'));
        transferOutDateSpan.textContent = formatted;
        transferInDateSpan.textContent = formatted;
    };

    // --- Rendering Functions ---
    const createActionButton = (icon, colorClass, onClick) => {
        const button = document.createElement('button');
        button.className = `p-1.5 ${colorClass} rounded`;
        button.innerHTML = icon;
        button.addEventListener('click', onClick);
        return button;
    };

    const renderTable = (tableElement, data, type) => {
        tableElement.innerHTML = '';
        if (data.length === 0) {
            tableElement.innerHTML = `<tr><td colspan="8" class="text-center py-4 text-gray-500">No data for this date.</td></tr>`;
            return;
        }
        data.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'border-b border-gray-700 hover:bg-gray-700';
            
            const editBtn = createActionButton(
                `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>`,
                'text-blue-400 hover:text-blue-300',
                (e) => {
                    e.stopPropagation();
                    openEditModal(item, type);
                }
            );

            const deleteBtn = createActionButton(
                `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`,
                'text-red-400 hover:text-red-300',
                (e) => {
                    e.stopPropagation();
                    console.log('Delete item:', item.id);
                }
            );
            
            const actionsCell = document.createElement('td');
            actionsCell.className = 'px-6 py-4 text-center space-x-2';
            actionsCell.appendChild(editBtn);
            actionsCell.appendChild(deleteBtn);

            row.innerHTML = `
                <td class="px-6 py-4 font-medium text-white">${item.imei}</td>
                <td class="px-6 py-4">${item.brand}</td>
                <td class="px-6 py-4">${item.model}</td>
                <td class="px-6 py-4">${item.variant}</td>
                <td class="px-6 py-4 text-gray-400">${item.notes}</td>
                <td class="px-6 py-4">${formatDate(item.date)}</td>
                <td class="px-6 py-4">${item.author}</td>
            `;
            row.appendChild(actionsCell);
            tableElement.appendChild(row);
        });
    };

    const refreshTables = () => {
        renderTable(transferOutTable, transfersOut, 'out');
        renderTable(transferInTable, transfersIn, 'in');
    };
    
    // --- Modal Logic ---
    const openEditModal = (item, type) => {
        document.getElementById('edit-id').value = item.id;
        document.getElementById('edit-type').value = type;
        document.getElementById('edit-imei').value = item.imei;
        document.getElementById('edit-notes').value = item.notes;
        editModal.classList.remove('hidden');
    };

    const closeEditModal = () => {
        editModal.classList.add('hidden');
        editForm.reset();
    };
    
    editForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const id = parseInt(document.getElementById('edit-id').value);
        const type = document.getElementById('edit-type').value;
        const notes = document.getElementById('edit-notes').value;

        if (type === 'out') {
            transfersOut = transfersOut.map(item => item.id === id ? { ...item, notes } : item);
        } else {
            transfersIn = transfersIn.map(item => item.id === id ? { ...item, notes } : item);
        }
        
        refreshTables();
        closeEditModal();
    });

    cancelEditBtn.addEventListener('click', closeEditModal);

    // --- Event Listeners ---
    todayBtn.addEventListener('click', () => setDateValue(new Date()));
    
    tabs.forEach(tab => {
        tab.addEventListener('click', (e) => {
            e.preventDefault();
            tabs.forEach(t => t.classList.remove('tab-active'));
            tab.classList.add('tab-active');
            
            tabContents.forEach(content => content.classList.add('hidden'));
            document.getElementById(`${tab.dataset.tab}-content`).classList.remove('hidden');
        });
    });
    
    themeToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        const isDark = document.documentElement.classList.contains('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        lightIcon.classList.toggle('hidden', isDark);
        darkIcon.classList.toggle('hidden', !isDark);
    });

    // --- Initialization ---
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
        darkIcon.classList.remove('hidden');
        lightIcon.classList.add('hidden');
    } else {
        document.documentElement.classList.remove('dark');
        darkIcon.classList.add('hidden');
        lightIcon.classList.remove('hidden');
    }

    setDateValue(new Date('2025-09-12T00:00:00'));
    refreshTables();
});
</script>
</body>
</html>
